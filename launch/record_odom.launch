<launch>
    <param name="use_sim_time" value="true"/>
    <arg name="pi"   value="3.141592654"/>

    <arg name="launch_static_tf"       default="true"/>
    <arg name="play_bag"               default="true"/>
    <arg name="sec"                    default="0"/>
    <arg name="rate"                   default="1"/>
    <!-- <arg name="bag_name"               default="2020-11-11-13-03-27_mapping_corcho1.bag"/> -->
    <!-- <arg name="bag_name"               default="2020-12-01-12-04-38_nocams_front_cam_noodomtf.bag"/> -->
    <!-- <arg name="bag_name"               default="2020-12-01-11-36-21_front_cam_nodomtf2.bag"/> -->
    <arg name="bag_name"               default="2020-12-01-10-45-22_front_cam_odomtf.bag   "/>
    <arg name="bag_file"               default="$(env HOME)/radar_fusion_bags/$(arg bag_name)"/>
    
    <node name="bag_player" type="play" pkg="rosbag" 
          args="$(arg bag_file) -r $(arg rate) --clock -s $(arg sec) -q -d 4" 
          output="screen" if="$(arg play_bag)" required="true">
        <remap from="tf" to="tf_non"/>
    </node>
   

    <!-- Odometry stuff -->
    <arg name="use_imu" default="false"/>
    <!-- Odometry ticks pure. This node susbcribes to /idmind_motors/wheel_odom and publishes /odom topic and tf from odom to base link without reading imu -->
    <node pkg="idmind_navigation" type="odometry_node.py" name="odometry_node_ticks" unless="$(arg use_imu)">
        <param name="/bot/base_width" value="0.65"/>
    </node>
    <node pkg="radar_experiments" type="upo_odometry.py" name="odometry_node_imu" if="$(arg use_imu)">
        <param name="use_imu" value="2"/>
    </node>

    
    
    <arg name="pi/2" value="1.5707963267948966"/>


    <include file="$(find radar_experiments)/launch/frames.launch" if="$(arg launch_static_tf)"/>
    
    <arg name="odom_bag_file" default="odom"/>
    <node name="record_gt" pkg="rosbag" type="record" args="/odom /tf /tf_static -o $(arg odom_bag_file)"/>

    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find radar_experiments)/rviz/odom.rviz"/>

</launch>